# -*- coding: utf-8 -*-
"""
Created on Wed Jun  6 14:14:57 2018

@author: sridh
"""
import pandas as pd
import time
data = pd.read_csv('full_data.csv')

data['cpu_quantile']= pd.qcut(data.CPU,  5,labels=["q1", "q2", "q3","q4","q5"] )
data.to_csv('full.csv',sep=',')

pd.qcut(range(5), 4)

#datapreprocessing, converting numbers to quartiles 

dataset = pd.read_csv('processedcpu.csv')
data['cpu_quantile']= pd.qcut(dataset.CPU,  4,labels=["q1", "q2", "q3","q4"] )
data['battery_quantile'] = pd.qcut(dataset.Battery, 4, labels=["q1", "q2", "q3","q4"])
data['memory_quantile'] = pd.qcut(dataset.Memory, 4, labels = ["q1", "q2", "q3","q4"])
data['network_quantile'] = pd.qcut(dataset.Network, 4, labels = ["q1", "q2", "q3","q4"], duplicates = 'drop')

dataset.CPU = data['cpu_quantile']
dataset.Battery = data['battery_quantile']
dataset.Memory = data['memory_quantile']
dataset.Network = data['network_quantile']
data.to_csv('finalprocessed.csv',sep=',')


data.groupby(['Type','Application']).mean()

#version2 mal 1454200314929 
data.head(10)

base ="" 
for i in range(0,len(data),2):
    base = base + "select * from ver1 where uid = '{}' and uuid between {} and {} union all ".format(data.iloc[i].id,int(data.iloc[i].time),int(data.iloc[i+1].time))
f = open('ver3_q16_mal.txt','w')
f.write(base)
f.close()

